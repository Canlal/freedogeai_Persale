<!DOCTYPE html>
<html>
<head>
    <title>FreeDogeAI Presale</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .wallet-btn {
            padding: 12px 24px;
            margin: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }
        #metamask {
            background: #f6851b;
            color: white;
        }
        #trustwallet {
            background: #3375bb;
            color: white;
        }
    </style>
</head>
<body>
    <h1>FreeDogeAI Presale</h1>
    
    <button id="metamask" class="wallet-btn">Connect MetaMask</button>
    <button id="trustwallet" class="wallet-btn">Connect Trust Wallet</button>

    <script>
    // 1. TÜM BEKLEYEN İSTEKLERİ TEMİZLE
    if (window.ethereum) {
        window.ethereum.removeAllListeners();
        if (window.ethereum._state) {
            window.ethereum._state.accounts = null;
        }
    }

    // 2. BAĞLANTI FONKSİYONU
    async function connectWallet() {
        try {
            // Cüzdan kontrolü
            if (!window.ethereum) {
                alert("Lütfen MetaMask veya Trust Wallet kurun!");
                return;
            }

            // Hesapları al
            const accounts = await window.ethereum.request({ 
                method: 'eth_requestAccounts',
                params: [] 
            });

            // Başarı mesajı
            const shortAddr = accounts[0].substring(0,6) + "..." + accounts[0].substring(38);
            alert("Bağlantı başarılı!\nCüzdan: " + shortAddr);

        } catch (error) {
            // Hata yönetimi
            if (error.code === 4001) {
                alert("Bağlantı reddedildi!");
            } else {
                alert("Hata: " + (error.message || "Bilinmeyen hata"));
            }
        }
    }

    // 3. BUTON AYARLARI
    document.getElementById('metamask').onclick = connectWallet;
    
    document.getElementById('trustwallet').onclick = function() {
        if (/Android|iPhone/i.test(navigator.userAgent)) {
            window.location.href = "trust://browser?url=" + encodeURIComponent(window.location.href);
        } else {
            connectWallet();
        }
    };
    </script>
</body>
</html>
