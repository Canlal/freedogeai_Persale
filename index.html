<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FreeDogeAI Presale</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <style>
        /* CSS kÄ±smÄ± Ã¶ncekiyle aynÄ±, space kazanmak iÃ§in kaldÄ±rdÄ±m */
        /* Ã–nceki CSS stilini buraya ekleyin */
    </style>
</head>
<body>
    <!-- HTML yapÄ±sÄ± Ã¶ncekiyle aynÄ± -->
    <!-- Ã–nceki HTML kodunu buraya ekleyin -->

    <script>
        // GerÃ§ek Web3 baÄŸlantÄ±sÄ±
        if (typeof window.ethereum !== 'undefined') {
            console.log('MetaMask yÃ¼klÃ¼!');
            window.web3 = new Web3(window.ethereum);
        } else if (typeof window.web3 !== 'undefined') {
            window.web3 = new Web3(window.web3.currentProvider);
        } else {
            console.log('Web3 saÄŸlayÄ±cÄ± bulunamadÄ±!');
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Constants
            const FDAI_PER_BNB = 120000000000;
            const PRESALE_END_DATE = new Date();
            PRESALE_END_DATE.setDate(PRESALE_END_DATE.getDate() + 90);

            // DOM Elements
            const languageBtn = document.getElementById('languageBtn');
            const currentLanguage = document.getElementById('currentLanguage');
            const languageDropdown = document.getElementById('languageDropdown');
            const connectWalletBtn = document.getElementById('connectWalletBtn');
            const walletInfo = document.getElementById('walletInfo');
            const walletAddress = document.getElementById('walletAddress');
            const bnbBalance = document.getElementById('bnbBalance');
            const bnbAmountInput = document.getElementById('bnbAmount');
            const calculationResult = document.getElementById('calculationResult');
            const fdaiAmount = document.getElementById('fdaiAmount');
            const buyBtn = document.getElementById('buyBtn');
            const walletModal = document.getElementById('walletModal');
            const closeModalBtn = document.getElementById('closeModalBtn');
            const metamaskOption = document.getElementById('metamaskOption');
            const trustwalletOption = document.getElementById('trustwalletOption');
            const daysElement = document.getElementById('days');
            const hoursElement = document.getElementById('hours');
            const minutesElement = document.getElementById('minutes');
            const secondsElement = document.getElementById('seconds');

            // GerÃ§ek cÃ¼zdan baÄŸlantÄ±sÄ±
            async function connectMetaMask() {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    const account = accounts[0];
                    
                    // Bakiye sorgulama
                    const balance = await window.web3.eth.getBalance(account);
                    const bnbBalance = window.web3.utils.fromWei(balance, 'ether');
                    
                    walletAddress.textContent = `${account.substring(0, 6)}...${account.substring(38)}`;
                    walletBalance.textContent = `BNB Balance: ${parseFloat(bnbBalance).toFixed(4)}`;
                    walletInfo.style.display = 'block';
                    connectWalletBtn.innerHTML = `<span>ðŸ”—</span><span>${translations[currentLang].connectText} âœ”</span>`;
                    buyBtn.disabled = false;
                    
                    return account;
                } catch (error) {
                    console.error("CÃ¼zdan baÄŸlantÄ± hatasÄ±:", error);
                    alert("CÃ¼zdan baÄŸlantÄ±sÄ± baÅŸarÄ±sÄ±z: " + error.message);
                }
            }

            // Trust Wallet baÄŸlantÄ±sÄ±
            async function connectTrustWallet() {
                if (window.ethereum.isTrust) {
                    return connectMetaMask(); // Trust Wallet MetaMask API'sini kullanÄ±r
                } else {
                    alert("LÃ¼tfen Trust Wallet mobil uygulamasÄ±nÄ± kullanÄ±n");
                }
            }

            // Token satÄ±n alma fonksiyonu (simÃ¼le edilmiÅŸ)
            async function buyFDAI() {
                const bnbAmount = parseFloat(bnbAmountInput.value);
                
                if (!bnbAmount || bnbAmount <= 0) {
                    alert("LÃ¼tfen geÃ§erli bir BNB miktarÄ± girin");
                    return;
                }

                try {
                    // GerÃ§ek iÅŸlem iÃ§in (test amaÃ§lÄ± simÃ¼le edildi)
                    const accounts = await web3.eth.getAccounts();
                    if (accounts.length === 0) {
                        alert("LÃ¼tfen Ã¶nce cÃ¼zdanÄ±nÄ±zÄ± baÄŸlayÄ±n");
                        return;
                    }

                    // Burada gerÃ§ek kontrat Ã§aÄŸrÄ±sÄ± yapÄ±lacak
                    console.log(`SatÄ±n alma iÅŸlemi: ${bnbAmount} BNB iÃ§in ${bnbAmount * FDAI_PER_BNB} FDAI`);
                    
                    // SimÃ¼le edilmiÅŸ iÅŸlem onayÄ±
                    alert(`${translations[currentLang].buyText} baÅŸarÄ±lÄ±!\n${bnbAmount} BNB karÅŸÄ±lÄ±ÄŸÄ±nda ${(bnbAmount * FDAI_PER_BNB).toLocaleString()} FDAI alacaksÄ±nÄ±z.`);
                    
                } catch (error) {
                    console.error("SatÄ±n alma hatasÄ±:", error);
                    alert("Ä°ÅŸlem baÅŸarÄ±sÄ±z: " + error.message);
                }
            }

            // DiÄŸer fonksiyonlar (geri sayÄ±m, dil deÄŸiÅŸtirme vb.) Ã¶ncekiyle aynÄ±
            // ...

            // Event listeners
            metamaskOption.addEventListener('click', connectMetaMask);
            trustwalletOption.addEventListener('click', connectTrustWallet);
            buyBtn.addEventListener('click', buyFDAI);
            // DiÄŸer event listener'lar...

            // Sayfa yÃ¼klendiÄŸinde geri sayÄ±mÄ± baÅŸlat
            updateCountdown();
            setInterval(updateCountdown, 1000);
        });
    </script>
</body>
</html>
